<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–í–∞–ª–µ–Ω—Ç–∏–Ω–∫–∞ üíï</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        body {
            font-family: system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #ff6b9d, #c44569, #f7931e);
            min-height: 100vh;
            color: white;
            overflow-x: hidden;
            user-select: none;
        }
        #generator, #valentines { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            min-height: 100vh; 
            padding: 20px; 
            text-align: center; 
        }
        h1 { font-size: clamp(2.5rem, 8vw, 4.5rem); margin-bottom: 30px; text-shadow: 0 4px 10px rgba(0,0,0,0.5); }
        input { 
            padding: 16px 24px; 
            font-size: 1.4rem; 
            width: 90%; 
            max-width: 400px; 
            border-radius: 50px; 
            border: none; 
            margin: 20px 0; 
            text-align: center; 
        }
        button { 
            padding: 16px 40px; 
            font-size: 1.4rem; 
            border: none; 
            border-radius: 50px; 
            cursor: pointer; 
            margin: 15px; 
            box-shadow: 0 6px 20px rgba(0,0,0,0.3); 
            transition: all 0.25s; 
        }
        #createBtn { background: #00ff9d; color: black; font-weight: bold; }
        #createBtn:hover { transform: scale(1.08); }
        #qrContainer { margin: 30px 0; background: white; padding: 15px; border-radius: 16px; }
        .hearts { position: fixed; inset: 0; pointer-events: none; z-index: 5; overflow: hidden; }
        .heart {
            position: absolute;
            font-size: 1.8rem;
            animation: fall linear forwards;
            opacity: 0.9;
        }
        @keyframes fall {
            0% { transform: translateY(-10vh) translateX(var(--x)) rotate(0deg); opacity: 1; }
            100% { transform: translateY(110vh) translateX(calc(var(--x) + var(--drift))) rotate(720deg); opacity: 0; }
        }
        .hidden { display: none !important; }
        @media (max-width: 500px) {
            h1 { font-size: 2.8rem; }
            button { padding: 14px 30px; font-size: 1.2rem; }
        }
    </style>
</head>
<body>

<div class="hearts" id="hearts"></div>

<div id="generator">
    <h1>–°—Ç–≤–æ—Ä–∏ —Å–≤–æ—é –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫—É üíï</h1>
    <input type="text" id="nameInput" placeholder="–í–≤–µ–¥–∏ —ñ–º'—è..." autocomplete="off">
    <button id="createBtn">–°—Ç–≤–æ—Ä–∏—Ç–∏ –º–æ—é –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫—É ‚Üí</button>
</div>

<div id="valentines" class="hidden">
    <h1 id="mainTitle">–¢–∏ –±—É–¥–µ—à –º–æ—î—é –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ—é, <span id="valName" style="color:#fff200;">...</span>? üíï</h1>
    
    <div class="buttons">
        <button class="yes" onclick="yesClick()">–¢–∞–∫ üòç</button>
        <button class="no" id="noBtn" onclick="noClick()">–ù—ñ ‚ùå</button>
    </div>

    <div id="qrContainer">
        <div id="qrcode"></div>
        <p style="color:#333; margin-top:10px;">–°–∫–∞–Ω—É–π, —â–æ–± –≤—ñ–¥–∫—Ä–∏—Ç–∏</p>
    </div>

    <button onclick="downloadQR()">–°–∫–∞—á–∞—Ç–∏ QR</button>
    <button onclick="copyLink()">–°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è</button>
</div>

<script>
// === –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ ===
const baseUrl = window.location.origin + window.location.pathname;
let name = new URLSearchParams(window.location.search).get('name');
name = name ? decodeURIComponent(name).trim() : '';

// === –Ø–∫—â–æ —î —ñ–º'—è –≤ URL ‚Äî –æ–¥—Ä–∞–∑—É –ø–æ–∫–∞–∑—É—î–º–æ –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫—É ===
const generator = document.getElementById('generator');
const valentines = document.getElementById('valentines');
const mainTitle = document.getElementById('mainTitle');
const valNameSpan = document.getElementById('valName');
const nameInput = document.getElementById('nameInput');
const qrDiv = document.getElementById('qrcode');

if (name && name.length > 0) {
    showValentine(name);
} else {
    generator.classList.remove('hidden');
}

// === –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è —Å–µ—Ä–¥–µ—á–æ–∫ ===
function createHeart() {
    const heart = document.createElement('div');
    heart.className = 'heart';
    heart.innerHTML = Math.random() > 0.5 ? 'üíï' : '‚ù§Ô∏è';
    heart.style.left = Math.random() * 100 + 'vw';
    heart.style.setProperty('--x', (Math.random() * 40 - 20) + 'vw');
    heart.style.setProperty('--drift', (Math.random() * 60 - 30) + 'vw');
    heart.style.animationDuration = (6 + Math.random() * 8) + 's';
    heart.style.animationDelay = Math.random() * 3 + 's';
    document.getElementById('hearts').appendChild(heart);
    setTimeout(() => heart.remove(), 15000);
}

setInterval(createHeart, 600);

// === –ü–æ–∫–∞–∑–∞—Ç–∏ –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫—É ===
function showValentine(nameVal) {
    name = nameVal;
    valNameSpan.textContent = name;
    mainTitle.innerHTML = `–¢–∏ –±—É–¥–µ—à –º–æ—î—é –≤–∞–ª–µ–Ω—Ç–∏–Ω–∫–æ—é, <span style="color:#fff200;">${name}</span>? üíï`;
    
    generator.classList.add('hidden');
    valentines.classList.remove('hidden');

    // QR-–∫–æ–¥ –∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º
    const link = `${baseUrl}?name=${encodeURIComponent(name)}`;
    qrDiv.innerHTML = '';
    new QRCode(qrDiv, {
        text: link,
        width: 220,
        height: 220,
        colorDark: "#000000",
        colorLight: "#ffffff",
        correctLevel: QRCode.CorrectLevel.H
    });
}

// === –ö–Ω–æ–ø–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è ===
document.getElementById('createBtn').onclick = () => {
    const inputVal = nameInput.value.trim();
    if (inputVal.length < 1) {
        alert("–í–≤–µ–¥–∏ —ñ–º'—è –±—É–¥—å –ª–∞—Å–∫–∞ üíï");
        return;
    }
    showValentine(inputVal);
};

// === –¢–∞–∫ / –ù—ñ –ª–æ–≥—ñ–∫–∞ (–º–æ–∂–Ω–∞ —Ä–æ–∑—à–∏—Ä–∏—Ç–∏ —è–∫ —Ä–∞–Ω—ñ—à–µ) ===
function yesClick() {
    alert("–Ø –∑–Ω–∞–≤(–ª–∞), —â–æ —Å–∫–∞–∂–µ—à –¢–ê–ö! üòçüíñ");
    // –¢—É—Ç –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ —Å–µ—Ä–¥–µ—á–∫–∞, –∑–º—ñ–Ω—É —Ç–µ–∫—Å—Ç—É —Ç–æ—â–æ
}

function noClick() {
    alert("–ù—É —è–∫ —Ç–æ –Ω—ñ? üò≠ –°–ø—Ä–æ–±—É–π —â–µ —Ä–∞–∑...");
    // –ú–æ–∂–Ω–∞ –∑—Ä–æ–±–∏—Ç–∏ –∫–Ω–æ–ø–∫—É, —â–æ —Ç—ñ–∫–∞—î ‚Äî —è–∫—â–æ —Ö–æ—á–µ—à
}

// === –°–∫–∞—á–∞—Ç–∏ QR ===
function downloadQR() {
    const canvas = qrDiv.querySelector('canvas');
    if (!canvas) return;
    const link = document.createElement('a');
    link.download = `valentine-${name || 'secret'}.png`;
    link.href = canvas.toDataURL('image/png');
    link.click();
}

// === –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ –ø–æ—Å–∏–ª–∞–Ω–Ω—è ===
function copyLink() {
    const link = `${baseUrl}?name=${encodeURIComponent(name)}`;
    navigator.clipboard.writeText(link).then(() => {
        alert("–ü–æ—Å–∏–ª–∞–Ω–Ω—è —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ! üíï");
    }).catch(() => {
        alert("–ù–µ –≤–∏–π—à–ª–æ —Å–∫–æ–ø—ñ—é–≤–∞—Ç–∏ :(\n–°–∫–æ–ø—ñ—é–π –≤—Ä—É—á–Ω—É:\n" + link);
    });
}
</script>
</body>
</html>
